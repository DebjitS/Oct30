Code for v.1.2